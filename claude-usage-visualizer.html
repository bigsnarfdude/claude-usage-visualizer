<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code Usage Pattern Analyzer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .file-input-container {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px dashed #dee2e6;
            text-align: center;
        }

        input[type="file"] {
            display: none;
        }

        .file-label {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .file-label:hover {
            transform: translateY(-2px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .chart-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
        }

        .analysis-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .category-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .insight-item, .recommendation-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .insight-icon, .recommendation-icon {
            font-size: 1.5em;
            flex-shrink: 0;
        }

        .insight-text, .recommendation-text {
            flex: 1;
            line-height: 1.4;
        }

        .recommendation-item {
            border-left-color: #28a745;
        }

        .category-tag {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
            border: 1px solid #667eea40;
            border-radius: 20px;
            font-size: 0.9em;
            color: #764ba2;
        }

        .instructions {
            background: #f0f4ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .instructions h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .instructions p {
            color: #555;
            line-height: 1.6;
        }

        .instructions code {
            background: #e8ecff;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Claude Code Usage Pattern Analyzer</h1>
            <p class="subtitle">Analyze your Claude Code usage patterns, categories, and timing</p>
            
            <div class="instructions">
                <h3>How to export your Claude Code data:</h3>
                <p>
                    1. Navigate to your Claude projects folder: <code>cd ~/.claude/projects/</code><br>
                    2. Combine all JSONL files: <code>cat */*.jsonl > all_claude_usage.jsonl</code><br>
                    3. Upload the combined file below to analyze your usage patterns
                </p>
            </div>

            <div class="file-input-container">
                <label for="file-input" class="file-label">
                    üìÅ Choose JSONL File
                </label>
                <input type="file" id="file-input" accept=".jsonl,.json">
                <div id="file-status" style="margin-top: 10px; color: #666;"></div>
            </div>
        </div>

        <div id="stats-container" style="display: none;">
            <div class="stats-grid" id="stats-grid"></div>

            <div class="chart-container">
                <h3 class="chart-title">üìä Request Categories Distribution</h3>
                <div class="chart-wrapper">
                    <canvas id="categoryChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üìà Usage Over Time (Hourly)</h3>
                <div class="chart-wrapper">
                    <canvas id="timeChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üìÖ Day of Week Pattern</h3>
                <div class="chart-wrapper">
                    <canvas id="dayChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üí∞ Token Usage by Category</h3>
                <div class="chart-wrapper">
                    <canvas id="tokenChart"></canvas>
                </div>
            </div>

            <div class="analysis-section">
                <h3 class="chart-title">üîç Top Request Patterns</h3>
                <div id="patterns-list"></div>
            </div>

            <div class="analysis-section">
                <h3 class="chart-title">‚è∞ Peak Usage Times</h3>
                <div id="peak-times"></div>
            </div>

            <div class="analysis-section">
                <h3 class="chart-title">üè∑Ô∏è Detected Topics</h3>
                <div id="topics-list"></div>
            </div>

            <div class="analysis-section">
                <h3 class="chart-title">üöÄ Productivity Insights</h3>
                <div id="insights-list"></div>
            </div>

            <div class="analysis-section">
                <h3 class="chart-title">üí° Recommendations</h3>
                <div id="recommendations-list"></div>
            </div>
        </div>
    </div>

    <script>
        let charts = {};

        function categorizeRequest(content) {
            if (!content || typeof content !== 'string') return 'Other';
            
            const lowerContent = content.toLowerCase();
            
            const categories = {
                'Code Writing': ['write', 'create', 'implement', 'build', 'make', 'generate', 'code', 'function', 'class', 'component'],
                'Debugging': ['fix', 'error', 'bug', 'issue', 'problem', 'wrong', 'broken', 'debug', 'trace', 'crash'],
                'Code Review': ['review', 'check', 'improve', 'optimize', 'refactor', 'clean', 'better', 'performance'],
                'Explanation': ['explain', 'what', 'how', 'why', 'understand', 'mean', 'work', 'tell me', 'describe'],
                'Testing': ['test', 'spec', 'unit test', 'integration', 'e2e', 'coverage', 'mock', 'stub'],
                'Documentation': ['document', 'readme', 'comment', 'docs', 'api', 'guide', 'tutorial'],
                'DevOps': ['deploy', 'docker', 'kubernetes', 'ci/cd', 'pipeline', 'server', 'nginx', 'aws', 'staging', 'production'],
                'Database': ['database', 'sql', 'query', 'migration', 'schema', 'table', 'postgres', 'mysql', 'mongodb'],
                'Git/Version Control': ['git', 'commit', 'branch', 'merge', 'pull', 'push', 'rebase', 'conflict', 'stash'],
                'Setup/Config': ['setup', 'install', 'configure', 'config', 'environment', 'package', 'dependency'],
                'Architecture': ['architecture', 'design', 'pattern', 'structure', 'system', 'microservice', 'api'],
                'UI/Frontend': ['ui', 'frontend', 'css', 'html', 'react', 'vue', 'component', 'style', 'layout'],
                'Security': ['security', 'auth', 'token', 'encrypt', 'permission', 'cors', 'vulnerability'],
                'Analysis': ['analyze', 'report', 'metric', 'performance', 'usage', 'data', 'statistics']
            };

            for (const [category, keywords] of Object.entries(categories)) {
                if (keywords.some(keyword => lowerContent.includes(keyword))) {
                    return category;
                }
            }
            
            return 'Other';
        }

        function extractTopics(content) {
            if (!content || typeof content !== 'string') return [];
            
            const topics = [];
            const lowerContent = content.toLowerCase();
            
            const techs = ['javascript', 'typescript', 'python', 'react', 'vue', 'node', 'express', 'django', 
                          'docker', 'kubernetes', 'aws', 'azure', 'postgres', 'mysql', 'mongodb', 'redis',
                          'graphql', 'rest', 'api', 'webpack', 'vite', 'npm', 'yarn', 'git'];
            
            techs.forEach(tech => {
                if (lowerContent.includes(tech)) topics.push(tech);
            });
            
            return topics;
        }

        function analyzePatterns(messages) {
            const patterns = {};
            const wordFrequency = {};
            
            messages.forEach(msg => {
                if (!msg || typeof msg !== 'string') return;
                
                const words = msg.toLowerCase().split(/\s+/);
                for (let i = 0; i < words.length - 1; i++) {
                    const bigram = words.slice(i, i + 2).join(' ');
                    if (bigram.length > 5) {
                        patterns[bigram] = (patterns[bigram] || 0) + 1;
                    }
                }
                
                words.forEach(word => {
                    if (word.length > 3) {
                        wordFrequency[word] = (wordFrequency[word] || 0) + 1;
                    }
                });
            });
            
            return { patterns, wordFrequency };
        }

        async function processFile(file) {
            const content = await file.text();
            const lines = content.trim().split('\n');
            
            const data = {
                messages: [],
                categories: {},
                hourlyUsage: new Array(24).fill(0),
                dayOfWeek: new Array(7).fill(0),
                tokensByCategory: {},
                topics: {},
                totalTokens: 0,
                totalCost: 0,
                sessionCount: new Set(),
                projectDirs: new Set(),
                dailyUsage: {},
                activeDays: 0,
                peakDay: 'N/A'
            };
            
            const entries = [];
            lines.forEach(line => {
                if (!line.trim()) return;
                try {
                    entries.push(JSON.parse(line));
                } catch (e) {
                    console.error('Parse error:', e.message);
                }
            });
            
            const messageCategories = {};
            let lastCategory = 'Other';
            
            entries.forEach(entry => {
                try {
                    if (entry.type === 'user' && entry.message?.content) {
                        let content = '';
                        
                        if (typeof entry.message.content === 'string') {
                            content = entry.message.content;
                        } else if (Array.isArray(entry.message.content)) {
                            const textItem = entry.message.content.find(c => c.type === 'text');
                            content = textItem?.text || '';
                        }
                        
                        if (content) {
                            data.messages.push(content);
                            const category = categorizeRequest(content);
                            data.categories[category] = (data.categories[category] || 0) + 1;
                            lastCategory = category;
                            
                            if (entry.uuid) {
                                messageCategories[entry.uuid] = category;
                            }
                            
                            const topics = extractTopics(content);
                            topics.forEach(topic => {
                                data.topics[topic] = (data.topics[topic] || 0) + 1;
                            });
                            
                            if (entry.timestamp) {
                                const date = new Date(entry.timestamp);
                                data.hourlyUsage[date.getHours()]++;
                                data.dayOfWeek[date.getDay()]++;
                                
                                // Track daily usage
                                const dateKey = date.toISOString().split('T')[0];
                                data.dailyUsage[dateKey] = (data.dailyUsage[dateKey] || 0) + 1;
                            }
                            
                            if (entry.sessionId) data.sessionCount.add(entry.sessionId);
                            if (entry.cwd) data.projectDirs.add(entry.cwd);
                        }
                    }
                    
                    if (entry.type === 'assistant' && entry.message?.usage) {
                        const usage = entry.message.usage;
                        const totalTokens = 
                            (usage.input_tokens || 0) + 
                            (usage.output_tokens || 0) + 
                            (usage.cache_creation_input_tokens || 0) + 
                            (usage.cache_read_input_tokens || 0);
                        
                        if (totalTokens > 0) {
                            data.totalTokens += totalTokens;
                            
                            const inputCost = ((usage.input_tokens || 0) + (usage.cache_creation_input_tokens || 0)) * 0.000015;
                            const outputCost = (usage.output_tokens || 0) * 0.000075;
                            data.totalCost += inputCost + outputCost;
                            
                            const category = (entry.parentUuid && messageCategories[entry.parentUuid]) || lastCategory;
                            data.tokensByCategory[category] = (data.tokensByCategory[category] || 0) + totalTokens;
                        }
                    }
                } catch (e) {
                    console.error('Processing error:', e);
                }
            });
            
            // Calculate daily usage stats
            data.activeDays = Object.keys(data.dailyUsage).length;
            if (data.activeDays > 0) {
                const maxUsage = Math.max(...Object.values(data.dailyUsage));
                const peakDate = Object.keys(data.dailyUsage).find(date => 
                    data.dailyUsage[date] === maxUsage
                );
                if (peakDate) {
                    const date = new Date(peakDate);
                    const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                    data.peakDay = `${dayNames[date.getDay()]} (${maxUsage} msgs)`;
                }
            }
            
            return data;
        }

        function displayAnalysis(data) {
            document.getElementById('stats-container').style.display = 'block';
            
            const statsHtml = `
                <div class="stat-card">
                    <div class="stat-label">Total Requests</div>
                    <div class="stat-value">${data.messages.length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Unique Sessions</div>
                    <div class="stat-value">${data.sessionCount.size}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Projects</div>
                    <div class="stat-value">${data.projectDirs.size}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Tokens</div>
                    <div class="stat-value">${data.totalTokens.toLocaleString()}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Estimated Cost</div>
                    <div class="stat-value">$${data.totalCost.toFixed(2)}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Avg Tokens/Request</div>
                    <div class="stat-value">${Math.round(data.totalTokens / Math.max(1, data.messages.length))}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Daily Avg Cost</div>
                    <div class="stat-value">$${(data.totalCost / Math.max(1, data.activeDays)).toFixed(2)}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Most Active Day</div>
                    <div class="stat-value">${data.peakDay}</div>
                </div>
            `;
            document.getElementById('stats-grid').innerHTML = statsHtml;
            
            // Category Chart
            if (charts.category) charts.category.destroy();
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            charts.category = new Chart(categoryCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(data.categories),
                    datasets: [{
                        data: Object.values(data.categories),
                        backgroundColor: [
                            '#667eea', '#764ba2', '#f093fb', '#f5576c',
                            '#4facfe', '#00f2fe', '#43e97b', '#38f9d7',
                            '#fa709a', '#fee140', '#30cfd0', '#330867'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
            
            // Time Chart
            if (charts.time) charts.time.destroy();
            const timeCtx = document.getElementById('timeChart').getContext('2d');
            charts.time = new Chart(timeCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                    datasets: [{
                        label: 'Requests',
                        data: data.hourlyUsage,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // Day Chart
            if (charts.day) charts.day.destroy();
            const dayCtx = document.getElementById('dayChart').getContext('2d');
            charts.day = new Chart(dayCtx, {
                type: 'bar',
                data: {
                    labels: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                    datasets: [{
                        label: 'Requests',
                        data: data.dayOfWeek,
                        backgroundColor: 'rgba(118, 75, 162, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // Token Chart
            if (Object.keys(data.tokensByCategory).length > 0) {
                if (charts.token) charts.token.destroy();
                const tokenCtx = document.getElementById('tokenChart').getContext('2d');
                charts.token = new Chart(tokenCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(data.tokensByCategory),
                        datasets: [{
                            label: 'Tokens',
                            data: Object.values(data.tokensByCategory),
                            backgroundColor: 'rgba(102, 126, 234, 0.8)'
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
            
            // Patterns
            const { patterns } = analyzePatterns(data.messages);
            const topPatterns = Object.entries(patterns)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            if (topPatterns.length > 0) {
                const patternsHtml = topPatterns.map(([pattern, count]) => 
                    `<div class="category-tag">"${pattern}" (${count}x)</div>`
                ).join('');
                document.getElementById('patterns-list').innerHTML = `<div class="category-list">${patternsHtml}</div>`;
            }
            
            // Peak times
            const peakHour = data.hourlyUsage.indexOf(Math.max(...data.hourlyUsage));
            const peakDay = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][
                data.dayOfWeek.indexOf(Math.max(...data.dayOfWeek))
            ];
            
            document.getElementById('peak-times').innerHTML = `
                <p><strong>Most Active Hour:</strong> ${peakHour}:00 - ${peakHour + 1}:00</p>
                <p><strong>Most Active Day:</strong> ${peakDay}</p>
                <p><strong>Average Daily Requests:</strong> ${(data.messages.length / 7).toFixed(1)}</p>
            `;
            
            // Topics
            const topTopics = Object.entries(data.topics)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 15);
            
            if (topTopics.length > 0) {
                const topicsHtml = topTopics.map(([topic, count]) => 
                    `<div class="category-tag">${topic} (${count})</div>`
                ).join('');
                document.getElementById('topics-list').innerHTML = `<div class="category-list">${topicsHtml}</div>`;
            }

            // Productivity Insights
            const insights = generateProductivityInsights(data);
            const insightsHtml = insights.map(insight => 
                `<div class="insight-item">
                    <div class="insight-icon">${insight.icon}</div>
                    <div class="insight-text">
                        <strong>${insight.title}</strong><br>
                        ${insight.description}
                    </div>
                </div>`
            ).join('');
            document.getElementById('insights-list').innerHTML = insightsHtml;

            // Recommendations
            const recommendations = generateRecommendations(data);
            const recommendationsHtml = recommendations.map(rec => 
                `<div class="recommendation-item">
                    <div class="recommendation-icon">${rec.icon}</div>
                    <div class="recommendation-text">
                        <strong>${rec.title}</strong><br>
                        ${rec.description}
                    </div>
                </div>`
            ).join('');
            document.getElementById('recommendations-list').innerHTML = recommendationsHtml;
        }

        function generateProductivityInsights(data) {
            const insights = [];
            
            // Peak hour analysis
            const maxHourUsage = Math.max(...data.hourlyUsage);
            const peakHour = data.hourlyUsage.indexOf(maxHourUsage);
            insights.push({
                icon: '‚è∞',
                title: 'Peak Performance Hour',
                description: `You're most active at ${peakHour}:00 with ${maxHourUsage} requests. Consider scheduling complex tasks during this time.`
            });
            
            // Cost efficiency
            const avgCostPerMessage = data.totalCost / Math.max(1, data.messages.length);
            if (avgCostPerMessage < 0.10) {
                insights.push({
                    icon: 'üí∞',
                    title: 'Cost Efficient Usage',
                    description: `Great job! Your average cost per request ($${avgCostPerMessage.toFixed(3)}) is below the typical range.`
                });
            }
            
            // Session patterns
            if (data.activeDays > 0) {
                const avgMsgsPerDay = data.messages.length / data.activeDays;
                insights.push({
                    icon: 'üìä',
                    title: 'Usage Pattern',
                    description: `You average ${avgMsgsPerDay.toFixed(1)} requests per active day across ${data.activeDays} days.`
                });
            }
            
            // Weekend vs weekday
            const weekendUsage = data.dayOfWeek[0] + data.dayOfWeek[6]; // Sun + Sat
            const weekdayUsage = data.dayOfWeek.slice(1, 6).reduce((a, b) => a + b, 0);
            if (weekendUsage > weekdayUsage * 0.3) {
                insights.push({
                    icon: 'üèñÔ∏è',
                    title: 'Weekend Warrior',
                    description: `You're active on weekends too! ${weekendUsage} weekend requests vs ${weekdayUsage} weekday requests.`
                });
            }
            
            return insights;
        }

        function generateRecommendations(data) {
            const recommendations = [];
            
            // Token usage optimization
            const avgTokens = data.totalTokens / Math.max(1, data.messages.length);
            if (avgTokens > 200) {
                recommendations.push({
                    icon: 'üéØ',
                    title: 'Optimize Request Length',
                    description: `Your requests average ${Math.round(avgTokens)} tokens. Try being more specific to reduce costs.`
                });
            }
            
            // Daily budget awareness
            const dailyAvgCost = data.totalCost / Math.max(1, data.activeDays);
            if (dailyAvgCost > 5) {
                recommendations.push({
                    icon: 'üí∏',
                    title: 'Budget Monitor',
                    description: `Daily average: $${dailyAvgCost.toFixed(2)}. Consider setting usage limits or using caching for repetitive tasks.`
                });
            }
            
            // Productivity timing
            const lowUsageHours = data.hourlyUsage.filter(usage => usage > 0).length;
            if (lowUsageHours < 8) {
                recommendations.push({
                    icon: '‚ö°',
                    title: 'Focus Your Sessions',
                    description: `You use Claude during ${lowUsageHours} different hours. Consider batching requests for better focus.`
                });
            }
            
            // Category diversification
            const categories = Object.keys(data.categories);
            if (categories.length < 3) {
                recommendations.push({
                    icon: 'üåü',
                    title: 'Explore More Use Cases',
                    description: `You primarily use ${categories.length} category(ies). Try exploring Claude for other tasks like documentation, testing, or code review.`
                });
            }
            
            return recommendations;
        }

        document.getElementById('file-input').addEventListener('change', async (event) => {
            const file = event.target.files[0];
            if (file) {
                document.getElementById('file-status').textContent = `Processing ${file.name}...`;
                
                try {
                    const data = await processFile(file);
                    displayAnalysis(data);
                    document.getElementById('file-status').textContent = `‚úÖ Analyzed ${data.messages.length} requests`;
                } catch (error) {
                    console.error('Error:', error);
                    document.getElementById('file-status').textContent = '‚ùå Error processing file. Check console.';
                }
            }
        });
    </script>
</body>
</html>